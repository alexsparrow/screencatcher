(this.webpackJsonpgiffy=this.webpackJsonpgiffy||[]).push([[0],{137:function(e,t,n){e.exports=n(182)},142:function(e,t,n){},144:function(e,t,n){},182:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(12),i=n.n(o),c=(n(142),n(24)),l=n.n(c),u=n(11),s=n(45),d=(n(144),n(6)),h=n(81),g=n.n(h),f=n(82),m=n.n(f),p=function(e,t,n,a,r,o,i,c){var l=document.createElement("canvas");l.width=o,l.height=i;var u=l.getContext("2d"),s=Date.now(),d=s,h=[],g=[];console.log(t),console.log(n),console.log(a),console.log(r),console.log(o),console.log(i);e.play(),e.onloadeddata=function(){s=Date.now(),function l(){var f=Date.now()-d;if(console.log(Date.now()-s),f>100){null===u||void 0===u||u.drawImage(e,t,n,a,r,0,0,o,i);var p=null===u||void 0===u?void 0:u.getImageData(0,0,o,i);d=Date.now(),h.push(null===p||void 0===p?void 0:p.data),g.push(f)}!e.paused&&Date.now()-s<3e4?requestAnimationFrame(l):c(m.a.encode(h,o,i,255,g))}()}},v=n(83),b=n.n(v),w=n(84),E=n(31),O=n.n(E);function j(e){return x.apply(this,arguments)}function x(){return(x=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,navigator.mediaDevices.getDisplayMedia(t);case 4:n=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error("Error: "+e.t0);case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}var C={video:{cursor:"always"},audio:!1},y=function(e){var t=e.chunksUrl;return r.a.createElement("video",{autoPlay:!0,controls:!0,style:{maxHeight:"100%",height:"100%",maxWidth:"100%",width:"100%"},src:t||void 0})},k=Object(w.a)((function(e){return r.a.createElement("div",{ref:e.getRef,style:{position:"absolute",left:e.x,top:e.y,width:e.width,height:e.height,touchAction:"none",borderWidth:5,borderColor:"red",borderStyle:"solid",pointerEvents:"all"}},r.a.createElement("div",{style:{width:"100%",height:"100%"}},e.x,",",e.y,",",e.width,",",e.height," ",r.a.createElement(d.Button,{onClick:function(){return e.onCrop([e.x,e.y,e.width,e.height])}},"Crop"),r.a.createElement(d.Button,{onClick:function(){return e.onCropCancel()}},"Cancel")))})),S=function(e){var t=e.onCrop,n=e.onCancel,a=r.a.useState({x:0,y:0,width:300,height:200}),o=Object(u.a)(a,2),i=o[0],c=o[1];return r.a.createElement(k,Object.assign({onCrop:t,onCropCancel:n,resizable:{edges:{left:!0,right:!0,bottom:!0,top:!0},modifiers:[O.a.modifiers.restrictRect({restriction:"parent"})]},draggable:{modifiers:[O.a.modifiers.restrictRect({restriction:"parent"})]},onDragMove:function(e){return c((function(t){return{x:t.x+e.dx,y:t.y+e.dy,width:t.width,height:t.height}}))},onResizeMove:function(e){var t=e.rect,n=t.width,a=t.height,r=e.deltaRect,o=r.left,i=r.top;c((function(e){return{x:e.x+o,y:e.y+i,width:n,height:a}}))}},i))},D=function(e){var t=e.recording,n=e.converting,a=e.startCapture,o=e.stopCapture,i=e.setGifWidth,c=e.gifWidth,l=e.setCropping,u=e.durationSecs,s=e.onExportGif,h=e.onExportPng,f=e.gif,m=e.png,p=e.progress,v=btoa(new Uint8Array(m).reduce((function(e,t){return e+String.fromCharCode(t)}),""));return r.a.createElement(d.Navbar,null,r.a.createElement(d.NavbarGroup,null,r.a.createElement(d.NavbarHeading,null,r.a.createElement("h3",null,"screen2gif")),r.a.createElement(d.Button,{disabled:t,onClick:a,icon:"record"},"Record"),r.a.createElement(d.Button,{disabled:!t,onClick:o,icon:"stop"},"Stop")),r.a.createElement(d.NavbarGroup,{align:d.Alignment.RIGHT},r.a.createElement(d.Button,{icon:"zoom-to-fit",onClick:function(){return l(!0)}},"Crop (PNG Only)"),r.a.createElement(d.NavbarDivider,null),r.a.createElement(d.Popover,{minimal:!0,content:r.a.createElement(d.Menu,null,r.a.createElement(d.MenuItem,{text:"Export to PNG",disabled:n,onClick:h}),r.a.createElement(d.MenuItem,{text:"Export to GIF",disabled:n,onClick:s}),r.a.createElement(d.MenuDivider,null),r.a.createElement(d.MenuItem,{text:"Image Width"},[256,512,1024,2048].map((function(e){return r.a.createElement(d.MenuItem,{text:"".concat(e),icon:c===e?"tick":null,onClick:function(){return i(e)}})}))))},r.a.createElement(d.Button,{icon:"export",text:"Export..."})),(m||f)&&r.a.createElement(d.Popover,{minimal:!0,content:r.a.createElement(d.Menu,null,r.a.createElement(d.MenuItem,{text:"Download PNG",download:"screen2gif.png",href:"data:image/png;base64,".concat(v),target:"_blank",icon:"download",disabled:!m}),r.a.createElement(d.MenuItem,{text:"Download GIF",download:"screen2gif.gif",href:f,target:"_blank",icon:"download",disabled:!f}))},r.a.createElement(d.Button,{icon:"download",text:"Download..."})),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.NavbarDivider,null),r.a.createElement("div",{style:{width:"10rem"}},r.a.createElement(d.ProgressBar,{value:p}))),r.a.createElement(d.NavbarDivider,null),"Duration: ",g()(u>0?u:0).format("0.0"),"s"))},M=function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)([]),c=Object(u.a)(i,2),h=c[0],g=c[1],f=Object(a.useState)(""),m=Object(u.a)(f,2),v=m[0],w=m[1],E=Object(a.useState)(!1),O=Object(u.a)(E,2),x=O[0],k=O[1],M=Object(a.useState)(!1),I=Object(u.a)(M,2),N=I[0],G=I[1],R=Object(a.useState)(null),W=Object(u.a)(R,2),B=W[0],P=W[1],H=Object(a.useState)(null),F=Object(u.a)(H,2),z=F[0],A=F[1],U=Object(a.useState)(Date.now()),L=Object(u.a)(U,2),T=L[0],J=L[1],V=Object(a.useState)(1024),_=Object(u.a)(V,2),q=_[0],$=_[1],K=Object(a.useState)(null),Q=Object(u.a)(K,2),X=Q[0],Y=Q[1],Z=Object(a.useState)(null),ee=Object(u.a)(Z,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(null),re=Object(u.a)(ae,2),oe=re[0],ie=re[1],ce=Object(a.useState)(0),le=Object(u.a)(ce,2),ue=le[0],se=le[1],de=Object(a.useState)(null),he=Object(u.a)(de,2),ge=he[0],fe=he[1],me=Object(a.useState)(!1),pe=Object(u.a)(me,2),ve=pe[0],be=pe[1],we=Object(a.useState)(),Ee=Object(u.a)(we,2),Oe=Ee[0],je=Ee[1],xe=function(){var e=Object(s.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(C);case 2:t=e.sent,n=new MediaRecorder(t),k(!0),n.ondataavailable=function(e){return g((function(t){return t.push(e.data),t}))},n.onstop=function(e){k(!1),w(URL.createObjectURL(h[0])),Y(t.getVideoTracks()[0].getSettings().width),ne(t.getVideoTracks()[0].getSettings().height)},n.start(),P(Date.now()),o(n);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ce=function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.stop(),A(Date.now());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=Object(a.useRef)(),ke=function(e){var t=function(){return{width:e.current.offsetWidth,height:e.current.offsetHeight}},n=Object(a.useState)({width:0,height:0}),r=Object(u.a)(n,2),o=r[0],i=r[1];return Object(a.useEffect)((function(){var n=function(){i(t())};return e.current&&i(t()),window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}),[e]),o}(ye),Se=ke.width,De=ke.height,Me=Se/De,Ie=X/te,Ne=0,Ge=0,Re=Se,We=De;if(Ie>Me){var Be=Se/X*te;Ge=.5*(De-Be),We=Be}else if(Me>Ie){var Pe=De/te*X;Ne=.5*(Se-Pe),Re=Pe}console.log(Ne,Ge,Re,We);Object(a.useEffect)((function(){setTimeout((function(){return J(Date.now())}),1e3)}),[T]);var He=((z||T)-(B||T))/1e3;return r.a.createElement("div",{className:"App"},r.a.createElement("main",{className:"bp3-dark"},r.a.createElement(D,{converting:N,durationSecs:He,gif:oe,gifWidth:q,onExportGif:function(){G(!0),function(e,t,n,a,r,o,i,c){var l=c/a*r,u=1*(n-t),s=Math.trunc(5*u/1e3);i(0),b.a.createGIF({video:e,gifWidth:c,gifHeight:l,numFrames:s,interval:.2,frameDuration:2,progressCallback:i},(function(e){if(!e.error){var t=e.image;o(t)}}))}(h,B,z,X,te,(function(e){ie(e),G(!1)}),se,q)},onExportPng:function(){var e=document.createElement("video");e.src=v,e.width=X,e.height=te,G(!0),console.log(Oe),console.log(Se),console.log(X),console.log(De),console.log(te);var t=1*X/Se,n=1*te/De;p(e,Oe?Math.round(Oe[0]*t):0,Oe?Math.round(Oe[1]*n):0,Oe?Math.round(Oe[2]*t):X,Oe?Math.round(Oe[3]*n):te,Oe?Math.round(Oe[2]*t):q,Oe?Math.round(Oe[3]*n):te*q/X,(function(e){G(!1),fe(e)}))},png:ge,progress:ue,recording:x,setCropping:be,setGifWidth:$,startCapture:xe,stopCapture:Ce}),r.a.createElement("div",{style:{height:"calc(100vh - 50px)",maxHeight:"calc(100vh - 50px)",width:"100vw",maxWidth:"100vw",padding:"1rem",backgroundColor:"#293742"}},r.a.createElement("div",{style:{width:"100%",maxWidth:"100%",height:"100%",maxHeight:"100%",position:"relative"},ref:ye},r.a.createElement("div",{style:{position:"absolute",left:Ne,top:Ge,width:Re,height:We,pointerEvents:"none"}},ve&&r.a.createElement(S,{onCrop:function(e){je(e),be(!1)},onCancel:function(){be(!1)}})),v?r.a.createElement(y,{chunksUrl:v}):r.a.createElement(d.NonIdealState,{title:"Nothing on tape yet",description:"Record something",icon:"warning-sign",action:x?void 0:r.a.createElement(d.Button,{disabled:x,onClick:xe,icon:"record"},"Record")})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(180),n(181);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[137,1,2]]]);
//# sourceMappingURL=main.8bd3a34b.chunk.js.map