(this.webpackJsonpgiffy=this.webpackJsonpgiffy||[]).push([[0],{138:function(e,t,n){e.exports=n(183)},143:function(e,t,n){},145:function(e,t,n){},183:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(13),i=n.n(o),c=(n(143),n(26)),l=n.n(c),u=n(12),s=n(43),d=(n(145),n(9)),h=n(81),g=n.n(h),f=n(82),m=n.n(f),v=function(e,t,n,a,r,o,i,c){var l=document.createElement("canvas");l.width=o,l.height=i;var u=l.getContext("2d"),s=Date.now(),d=s,h=[],g=[];console.log(t),console.log(n),console.log(a),console.log(r),console.log(o),console.log(i);e.play(),e.onloadeddata=function(){s=Date.now(),function l(){var f=Date.now()-d;if(console.log(Date.now()-s),f>100){null===u||void 0===u||u.drawImage(e,t,n,a,r,0,0,o,i);var v=null===u||void 0===u?void 0:u.getImageData(0,0,o,i);d=Date.now(),h.push(null===v||void 0===v?void 0:v.data),g.push(f)}!e.paused&&Date.now()-s<3e4?requestAnimationFrame(l):c(m.a.encode(h,o,i,255,g))}()}},b=n(83),p=n.n(b),w=n(84),E=n(32),O=n.n(E);function j(e){return y.apply(this,arguments)}function y(){return(y=Object(s.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,navigator.mediaDevices.getDisplayMedia(t);case 4:n=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error("Error: "+e.t0);case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}var x={video:{cursor:"always"},audio:!1},S=function(e){var t=e.chunksUrl;return r.a.createElement("video",{autoPlay:!0,controls:!0,style:{maxHeight:"100%",height:"100%",maxWidth:"100%",width:"100%"},src:t||void 0})},k=Object(w.a)((function(e){return r.a.createElement("div",{ref:e.getRef,style:{position:"absolute",left:e.x,top:e.y,width:e.width,height:e.height,touchAction:"none",borderWidth:5,borderColor:"red",borderStyle:"solid",pointerEvents:"all"}},r.a.createElement("div",{style:{width:"100%",height:"100%"}},e.x,",",e.y,",",e.width,",",e.height," ",r.a.createElement(d.Button,{onClick:function(){return e.onCrop([e.x,e.y,e.width,e.height])}},"Crop")))})),D=function(e){var t=e.onCrop,n=r.a.useState({x:0,y:0,width:300,height:200}),a=Object(u.a)(n,2),o=a[0],i=a[1];return r.a.createElement(k,Object.assign({onCrop:t,resizable:{edges:{left:!0,right:!0,bottom:!0,top:!0},modifiers:[O.a.modifiers.restrictRect({restriction:"parent"})]},draggable:{modifiers:[O.a.modifiers.restrictRect({restriction:"parent"})]},onDragMove:function(e){return i((function(t){return{x:t.x+e.dx,y:t.y+e.dy,width:t.width,height:t.height}}))},onResizeMove:function(e){var t=e.rect,n=t.width,a=t.height,r=e.deltaRect,o=r.left,c=r.top;i((function(e){return{x:e.x+o,y:e.y+c,width:n,height:a}}))}},o))},C=function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)([]),c=Object(u.a)(i,2),h=c[0],f=c[1],m=Object(a.useState)(""),b=Object(u.a)(m,2),w=b[0],E=b[1],O=Object(a.useState)(!1),y=Object(u.a)(O,2),k=y[0],C=y[1],N=Object(a.useState)(!1),R=Object(u.a)(N,2),B=R[0],M=R[1],G=Object(a.useState)(null),W=Object(u.a)(G,2),F=W[0],I=W[1],A=Object(a.useState)(null),H=Object(u.a)(A,2),z=H[0],L=H[1],P=Object(a.useState)(Date.now()),U=Object(u.a)(P,2),T=U[0],J=U[1],V=Object(a.useState)(1024),_=Object(u.a)(V,2),q=_[0],$=_[1],K=Object(a.useState)(null),Q=Object(u.a)(K,2),X=Q[0],Y=Q[1],Z=Object(a.useState)(null),ee=Object(u.a)(Z,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(null),re=Object(u.a)(ae,2),oe=re[0],ie=re[1],ce=Object(a.useState)(0),le=Object(u.a)(ce,2),ue=le[0],se=le[1],de=Object(a.useState)(null),he=Object(u.a)(de,2),ge=he[0],fe=he[1],me=Object(a.useState)(!1),ve=Object(u.a)(me,2),be=ve[0],pe=ve[1],we=Object(a.useState)(),Ee=Object(u.a)(we,2),Oe=Ee[0],je=Ee[1],ye=function(){var e=Object(s.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(x);case 2:t=e.sent,n=new MediaRecorder(t),C(!0),n.ondataavailable=function(e){return f((function(t){return t.push(e.data),t}))},n.onstop=function(e){C(!1),E(URL.createObjectURL(h[0])),Y(t.getVideoTracks()[0].getSettings().width),ne(t.getVideoTracks()[0].getSettings().height)},n.start(),I(Date.now()),o(n);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.stop(),L(Date.now());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Se=Object(a.useRef)(),ke=function(e){var t=function(){return{width:e.current.offsetWidth,height:e.current.offsetHeight}},n=Object(a.useState)({width:0,height:0}),r=Object(u.a)(n,2),o=r[0],i=r[1];return Object(a.useEffect)((function(){var n=function(){i(t())};return e.current&&i(t()),window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}),[e]),o}(Se),De=ke.width,Ce=ke.height,Ne=De/Ce,Re=X/te,Be=0,Me=0,Ge=De,We=Ce;if(Re>Ne){var Fe=De/X*te;Me=.5*(Ce-Fe),We=Fe}else if(Ne>Re){var Ie=Ce/te*X;Be=.5*(De-Ie),Ge=Ie}console.log(Be,Me,Ge,We);Object(a.useEffect)((function(){setTimeout((function(){return J(Date.now())}),1e3)}),[T]);var Ae=((z||T)-(F||T))/1e3,He=btoa(new Uint8Array(ge).reduce((function(e,t){return e+String.fromCharCode(t)}),""));return r.a.createElement("div",{className:"App"},r.a.createElement("main",{className:"bp3-dark"},r.a.createElement(d.Navbar,null,r.a.createElement(d.NavbarGroup,null,r.a.createElement(d.NavbarHeading,null,r.a.createElement("h3",null,"screen2gif")),r.a.createElement(d.Button,{disabled:k,onClick:ye,icon:"record"},"Record"),r.a.createElement(d.Button,{disabled:!k,onClick:xe,icon:"stop"},"Stop"),r.a.createElement(d.NavbarDivider,null),"Width (px)",r.a.createElement("div",{style:{paddingLeft:"1rem"}},r.a.createElement(d.Slider,{min:256,max:2048,stepSize:256,labelStepSize:512,onChange:$,value:q}))),r.a.createElement(d.NavbarGroup,{align:d.Alignment.RIGHT},r.a.createElement(d.Button,{onClick:function(){return pe(!0)}},"Crop (PNG Only)"),r.a.createElement(d.Button,{disabled:B,onClick:function(){M(!0),function(e,t,n,a,r,o,i,c){var l=c/a*r,u=1*(n-t),s=Math.trunc(5*u/1e3);i(0),p.a.createGIF({video:e,gifWidth:c,gifHeight:l,numFrames:s,interval:.2,frameDuration:2,progressCallback:i},(function(e){if(!e.error){var t=e.image;o(t)}}))}(h,F,z,X,te,(function(e){ie(e),M(!1)}),se,q)}},"Export (GIF)"),oe&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.AnchorButton,{download:"screen2gif.gif",href:oe,target:"_blank",icon:"download",disabled:!oe},"Download GIF")),r.a.createElement(d.NavbarDivider,null),r.a.createElement(d.Button,{onClick:function(){var e=document.createElement("video");e.src=w,e.width=X,e.height=te,M(!0),console.log(Oe),console.log(De),console.log(X),console.log(Ce),console.log(te);var t=1*X/De,n=1*te/Ce;v(e,Oe?Math.round(Oe[0]*t):0,Oe?Math.round(Oe[1]*n):0,Oe?Math.round(Oe[2]*t):X,Oe?Math.round(Oe[3]*n):te,Oe?Math.round(Oe[2]*t):q,Oe?Math.round(Oe[3]*n):te*q/X,(function(e){M(!1),fe(e)}))},disabled:B},"Export (PNG)"),ge&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.AnchorButton,{download:"screen2gif.png",href:"data:image/png;base64,".concat(He),target:"_blank",icon:"download",disabled:!ge},"Download PNG")),B&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.NavbarDivider,null),r.a.createElement("div",{style:{width:"10rem"}},r.a.createElement(d.ProgressBar,{value:ue}))),r.a.createElement(d.NavbarDivider,null),"Duration:"," ",g()(Ae>0?Ae:0).format("0.0"),"s")),r.a.createElement("div",{style:{height:"calc(100vh - 50px)",maxHeight:"calc(100vh - 50px)",width:"100vw",maxWidth:"100vw",padding:"1rem",backgroundColor:"#293742"}},r.a.createElement("div",{style:{width:"100%",maxWidth:"100%",height:"100%",maxHeight:"100%",position:"relative"},ref:Se},r.a.createElement("div",{style:{position:"absolute",left:Be,top:Me,width:Ge,height:We,pointerEvents:"none"}},be&&r.a.createElement(D,{onCrop:function(e){je(e),pe(!1)}})),w?r.a.createElement(S,{chunksUrl:w}):r.a.createElement(d.NonIdealState,{title:"Nothing on tape yet",description:"Record something",icon:"warning-sign",action:k?void 0:r.a.createElement(d.Button,{disabled:k,onClick:ye,icon:"record"},"Record")})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(181),n(182);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(C,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[138,1,2]]]);
//# sourceMappingURL=main.c8f94041.chunk.js.map